### DepencyManagement 应用场景

在项目顶层的POM文件中，我们会看到dependencyManagement元素，通过它元素来管理jar包的版本，让子项目中引用一个依赖而不用显示的列出版本号，Maven会沿着父子层次向上走，直到找到一个拥有dependencyManagement元素的项目

### 什么是服务注册与发现

Eureka采用了CS的设计结构我Eureka Server服务注册功能的服务器，它是服务注册中心。而系统中的其他微服务，使用Eureka的客户端连接到Eureka Server并维持心跳连接。这样系统的维护人员就可以通过Eureka Server来监控系统中各个微服务是否正常运行。这点和zookeeper很相似

### ZooKeeper

#### 概念

是一个基于观察者设计模式设计的分布式服务管理框架，它负责存储和管理数据，然后接受观察者的注册，一旦这些数据的状态发生变化，ZooKeeper就将负责通知已经在ZooKeeper上注册的那些观察者作出相应的反应

#### 特点

- ZooKeeper：一个领导者Leader，多个跟随者Follower组成的集群
- 集群中只要有半数以上节点存活，ZooKeeper集群就能存活
- 全局数据一致，每一个Server保存一份相同的数据副本，Client无论连接到哪个Server，数据都是一致的
- 更新请求顺序进行，来自同一个Client的更新请求按其发送顺序依次执行
- 数据更新原子性，一次数据更新要么成功，要么失败
- 实时性，在一定时间范围内，Client能读到最新的数据

#### spring-cloud zookeeper

zookeeper 是临时节点

#### CAP原则

CAP定理：指的是在一个分布式系统中，一致性、可用性、分区容错性三者不可兼得

一致性(Consistency)：分布式系统中所有主机在同一时刻是否可以保证完全相同的数据备份，若具有则该分布式系统具有一致性

可用性(Availability)：在集群中，部分节点发生故障后，是否会影响对客户端读写请求的响应，注意，若在短时间内会影响，其也不具有这里说说的"可用性"

分区容错性(Partition tolerance)：分布式系统中的一台主机称为一个分区，分布式系统中各个主机无法保证数据的一致性，即不具有一致性是一种错误；分布式系统无法及时响应客户端请求，即不具有可用性也是一种错误；对于分布式系统，必须要具有对这些错误的"包容性",即容错性，这是必须的

##### CAP组合

CA：不是分布式架构，就使用这种，关系数据库按照CA进行设计 ，放弃分区容错性，因为没有分区

AP：加强可用性和分区容错性,放弃立即一致性（强一致性），追求最终一致性，比如Eureka 

CP：强调强一致性和分区容错性，放弃可用性，比如Zookeeper,master在宕机后选举Leader期间不提供服务

在分布式系统中AP运用的最多，因为他放弃的是强一致性，追求的是最终一致性，性价比最高，比如12小时内退款，微信2小时内提现到账，只要在用户的可接受范围内，保证一致性即可

#### Ribbon 本地负载均衡客户端 VS Nginx服务端负载均衡

Nginx是服务器负载均衡，客户端所有请求都会交给Nginx，然后由Nginx实现转发请求。即负载均衡是由服务端实现的

Ribbon本地负载，在调用微服务接口时候，会在注册中心上获取信息服务列表之后缓存到JVM本地，从而在本地实现RPC远程服务调用技术

集中式LB：即在服务的消费方和提供方之间使用独立的LB设备，由该设备把访问请求通过某种策略转发至服务的提供方

进程内LB：将LB逻辑集成到消费方，消费方从服务注册中心获知有哪些地址可用，然后自己再从这些地址中选择出一个合适的服务器！

#### Hystrix断路器

Hystrix 能够保证在一个依赖出问题的情况下，不会导致整体服务失败，避免级联故障，以提高分布式系统的弹性

#### 服务降级

服务器忙碌或者网络拥挤时，不让客户端等待立即返回一个友好的提示fallback，对方系统不可用了，需要一个兜底的方法，不要耗死。