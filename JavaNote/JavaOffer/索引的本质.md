## 数据库索引

索引是帮助数据库高效获取数据的排好序的数据结构
数据结构: 二叉搜索树 -> 红黑树 -> B树 -> B+树

### 为什么B+树比B树更适合数据库索引

- B+树的磁盘读写代价更低：B+树的内部节点并没有指向关键字具体信息的指针，因此其内部节点相对B树更小，如果把所有同一内部节点的关键字存放在同一盘块中，那么盘块所能容纳的关键字数量也越多，一次性读入内存的需要查找的关键字也就越多，相对IO读写次数就降低了
- B+树的查询效率更加稳定：由于非终结点并不是最终指向文件内容的结点，而只是叶子结点中关键字的索引。所以任何关键字的查找必须走一条从根结点到叶子结点的路。所有关键字查询的路径长度相同，导致每一个数据的查询效率相当。
- 由于B+树的数据都存储在叶子结点中，分支结点均为索引，方便扫库，只需要扫一遍叶子结点即可，但是B树因为其分支结点同样存储着数据，我们要找到具体的数据，需要进行一次中序遍历按序来扫，所以B+树更加适合在区间查询的情况，所以通常B+树用于数据库索引。


### 组合索引

```sql
-- 建立单独索引
alter table user add index `idx_nickname` (`nickname`);

-- 执行and语句
-- 执行or语句
```

加上索引后and查询是可以走索引的，但是只有一个索引起作用，对于另一个索引字段还是要进行遍历，而且and查询会根据关联性高(符合该条件的行数少)选择具体走哪个索引

```sql
-- 建立联合索引
alter table user add index `idx_composition` (`nickname`, `company`)
```

加上组合索引后，组合索引起作用，只需查询一条符合结果的数据，效率要比单独索引高，但是复合索引对于or查询不起作用

并且组合索引中nickname在前时，单独查询nickname会走索引，单独查询company不会走索引